<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0/EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="pj1.mapper.QnaMapper">
	<select id="selectQnaList" resultType="pj1.dto.QnaDto">
		select qna_idx,
		item_idx,
		mem_id,
		qna_title,
		date_format(qna_writeDate, '%m.%d %H:%i') as
		qna_writeDate,
		qna_hits
		from
		qna
		where qna_save = 'Y'
		order by qna_idx desc
	</select>
	<select id="selectQnaAnswer" resultType="pj1.dto.QnaDto">
		select
		qna_comment_idx,
		qna_comment_content,
		date_format(qna_comment_writeDate, '%m.%d %H:%i') as
		qna_comment_writeDate
		from qna q inner join qna_comment qc on q.qna_idx = qc.qna_idx
		where q.qna_idx = #{qnaIdx}
	</select>
	<insert id="insertQna" parameterType="pj1.dto.QnaDto">
		insert into qna
		(mem_id,
		qna_title, qna_contents, qna_writeDate)
		values (
		#{memId},
		#{qnaTitle},
		#{qnaContents}, now()
		)
	</insert>

	<insert id="insertQnaComment" parameterType="pj1.dto.QnaDto">
		insert into qna_comment
		(qna_idx, qna_comment_content,
		date_format(qna_comment_writedate, '%m.%d %H:%i') as
		qna_comment_writedate)
		values (
		#{qna_idx},
		#{qna_comment_content}, now()
		)
	</insert>
	<select id="selectQnaDetail" parameterType="int"
		resultType="pj1.dto.QnaDto">
		select qna_idx, qna_contents, mem_id,
		date_format(qna_writeDate, '%m.%d %H:%i') as
		qna_writeDate,
		qna_hits
		from qna
		where qna_idx
		=
		#{qnaIdx}
	</select>

	<delete id="deleteQna" parameterType="int">
		update qna set
		qna_save =
		'N'
		where qna_idx = #{qnaIdx}
	</delete>

</mapper>
